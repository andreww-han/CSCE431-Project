<div class='wrapper'>
  <%= render(:partial => 'navbar', :locals => {:is_logged_in => true}) %>
  <div class='container'>
    <p id="notice"><%= notice %></p>

    <p>
      <strong>Name:</strong>
      <%= @member.name %>
    </p>

    <p>
      <strong>Points:</strong>
      <%= @member.totalPoints %>
    </p>

    <p>
      <strong>Bio:</strong>
      <% @member_id = Member.where(uid: current_admin.uid).first().id %>
      <% @bio = Bio.where(member_id: @member.id) %>
      <%if @bio.empty? && @member_id == @member.id%>
        <%= link_to 'Add a bio', new_bio_path(@bio), :class => 'underline' %>
      <%else%>
        <%= @bio.first().body %>
        <%if @member_id == @member.id%>
          <%= link_to 'Edit Bio', edit_bio_path(@bio.first()), :class => 'underline' %>
        <%end%>
      <%end%>
    </p>

    <p>
      <strong>Admin:</strong>
      <% if @member.isAdmin == true %>
        <td> Yes </td>
      <% else %>
        <td> No </td>
      <% end %>
    </p>

    <p>
      <strong>Owner:</strong>
      <% if @member.isOwner == true %>
        <td> Yes </td>
      <% else %>
        <td> No </td>
      <% end %>
    </p>

    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Body</th>
          <th>Author</th>
          <th>Likes</th>
          <th colspan="3"></th>
        </tr>
      </thead>

    <tbody>

      <% @member_id = Member.where(uid: current_admin.uid).first().id %>
      <% Post.where(member_id: @member_id).find_each do |post| %>

        <tr>
          <td><%= post.title %></td>
          <td><%= post.body %></td>

          <% @user = Member.find(post.member_id) %>

          <td><%= @user.name %></td>
          <td><%= post.likes %></td>

          <td><%= link_to 'Show', post %></td>

          <% if(Like.exists?(:member_id => @member_id, :post_id => post.id)) %>
            <% @like = Like.find_by(member_id: @member_id, post_id: post.id) %>
            <td><%= link_to("Un-like This Post", delete_like_path(@like, :post_id => post.id, :member_id => @member_id), data: { confirm: 'Are you sure?' }) %></td>
          <% else %>
            <td><%= link_to("Like This Post", likes_path(:like => @like, :post_id => post.id, :member_id => @member_id), method: :create) %>
          <% end %></td>

          <% if @member_id == post.member_id %>
            <td><%= link_to 'Edit Post', edit_post_path(post) %></td>
          <% end %>

          <% if @is_admin || @member_id == post.member_id %>
            <td><%= link_to 'Delete Post', post, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <% end %>

        </tr>

      <% end %>
    </tbody>
  </table>

    <%= link_to 'Edit Member', edit_member_path(@member), :class => 'underline' %> |
    <%= link_to 'Back', members_path, :class => 'underline' %>
  </div>
</div>
